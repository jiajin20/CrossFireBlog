<!--
 * @Author: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @Date: 2024-10-29 15:59:50
 * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @LastEditTime: 2024-11-10 11:49:20
 * @FilePath: \WebContentc:\JAVAprogram\innerExpress2.0\WebContent\statics\html\index.html
 * @Description: ËøôÊòØÈªòËÆ§ËÆæÁΩÆ,ËØ∑ËÆæÁΩÆ`customMade`, ÊâìÂºÄkoroFileHeaderÊü•ÁúãÈÖçÁΩÆ ËøõË°åËÆæÁΩÆ: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>È¶ñÈ°µ</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="/statics/css/global.css">
    <link rel="stylesheet" href="/statics/css/indexs.css">
    <link rel="stylesheet" href="/statics/css/tab.css">
    <link rel="stylesheet" href="/statics/css/myPagination.css">
    <style>
        /* ‰ΩøÈ°µÈù¢È´òÂ∫¶‰∏∫100%ÔºåÂÆπÂô®‰ΩøÁî®flexÂ∏ÉÂ±Ä */
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        .page-wrapper {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        #app {
            flex-grow: 1;
            /* ‰ΩøÂÜÖÂÆπÈÉ®ÂàÜÂç†ÊçÆÂâ©‰ΩôÁ©∫Èó¥ */
        }

        .footer {
            background-color: #f1f1f1;
            padding: 20px;
            text-align: center;
            width: 100%;
            position: relative;
            /* ÈªòËÆ§‰ΩçÁΩÆÔºå‰øùÊåÅÂú®Â∫ïÈÉ® */
        }

        .footer-line {
            color: #888;
        }
    </style>
</head>

<body>

    <div class="page-wrapper">
        <nav class="nav-bar-holder" id="nav">
            <div class="nav-bar" id="nav-bar">
                <div class="logo-box">
                    <a href="http://localhost:8080/index" class="blog-title ta-c"><img style="vertical-align: top;" alt="logo"
                            src="/statics/images/logo.png" /></a>
                </div>
                <div class="nb-a-holder" id="home"><a id="active" class="nb-a ta-c" href="index">È¶ñÈ°µ</a></div>
                <div class="nb-a-holder"><a class="nb-a ta-c" href="/statics/html/category.html">ÂàÜÁ±ª</a></div>
                <div class="nb-a-holder">
                    <a :href="'/personInfo/' + (personInfo.userId || '')" class="nb-a ta-c">‰∏™‰∫∫‰ø°ÊÅØ</a>
                </div>

                <div class="nb-a-holder-last">
                    <div class="nb-a-holder-small">
                        <a class="a-login" @click="logout" style="cursor: pointer;">Ê≥®ÈîÄ</a>
                    </div>
                </div>

            </div>
        </nav>

        <div id="app">




            <el-container class="big-container" id="particles-js">
                <div class="article">
                    <div id="article-holder" class="left-holder">
                        <div id="article-holder" style="width: 100%; float: left" v-infinite-scroll="load" gutter="20">
                            <div v-if="blogs.length">
                                <div class="article-box" span="6" :offset="2" v-for="(blog, index) in blogs"
                                    :key="blog.id">
                                    <div class="ab-content">
                                        <a class="article-img-box" :href="'/blog/' + blog.blogId">
                                            <img class="lazy-image article-img" data-src="" alt=""
                                                src="/statics/images/article.jpg">
                                        </a>
                                        <div class="article-title">
                                            <a>{{ blog.title || 'ÊöÇÊó†Ê†áÈ¢ò' }}</a>
                                        </div>
                                        <div class="article-detail-box c-666">
                                            {{ blog.content }}
                                        </div>
                                        <span class="article-tail-box">
                                            <i class="fl"
                                                style="background-image: url('/statics/images/looks.svg')"></i>
                                            <span class="read-number c-999 fl">{{ blog.readed }}</span>
                                            <span class="comment-number c-999 fl"
                                                v-if="blog.typeId === 1">&nbsp;&nbsp;Â®±‰πê</span>
                                            <span class="comment-number c-999 fl"
                                                v-else-if="blog.typeId === 2">&nbsp;&nbsp;‰ΩìËÇ≤</span>
                                            <span class="comment-number c-999 fl"
                                                v-else-if="blog.typeId === 3">&nbsp;&nbsp;ÊñáÂåñ</span>
                                            <span class="comment-number c-999 fl" v-else>&nbsp;&nbsp;Ê≠£ËÉΩÈáè</span>
                                            <span class="article-date c-999">{{ blog.createDate | dateFormate }}</span>
                                            <span class="article-author one-line-overflow c-999">{{ blog.authorName
                                                }}</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div v-else>Ê≤°ÊúâÊâæÂà∞Áõ∏ÂÖ≥ÂÜÖÂÆπ„ÄÇ</div>
                        </div>

                        <el-pagination class="pagination fl" id="pagination" v-if="pageParam.totalSize > 0"
                            :current-page="pageParam.current" :page-size="pageParam.size" :total="pageParam.totalNumber"
                            @current-change="handlePageChange" layout="total, prev, pager, next, jumper">
                        </el-pagination>
                    </div>
                    <div class="right-holder">
                        <!-- ‰∏™‰∫∫‰ªãÁªçÂíåÂÖ∂‰ªñÂÜÖÂÆπ -->
                        <div class="column-container">
                            <ul class="column_box" id="like-box">
                                <li class="column-title">
                                    <span class="at-sort b-b-ece fl"><a
                                            class="at-sort-comment-a c-666 fl">‰∏™‰∫∫‰ªãÁªç</a></span>
                                </li>
                                <li class="person-img-li">
                                    <a :href="'/personInfo/' + (personInfo.userId || '')">
                                        <el-image id="person-img" style="width: 80px; height: 80px;"
                                            :src="personInfo.avatar"></el-image>
                                    </a>
                                </li>
                                <li class="person-intro-detail gradient-text">
                                    <h1>{{personInfo.nickname }}</h1>
                                </li>
                                <li class="person-intro-detail">
                                    <h3>ÁΩëÁ´ôÁÆÄ‰ªãÔºö„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ</h3>
                                </li>
                                <li class="person-intro-detail">
                                    <h3>ÊâÄÂú®Âú∞ÔºöÂõõÂ∑ù</h3>
                                </li>
                                <li class="person-intro-detail">
                                    <h3>ÁºñÁ®ã</h3>
                                </li>
                                <li class="person-intro-detail">
                                    <h3>ÁΩëÁ´ôÁéØÂ¢ÉÔºöDocker + Go + Mysql + Vue</h3>
                                </li>
                            </ul>
                        </div>

                        <div class="column-container">
                            <ul class="column_box" id="like-box">
                                <li class="column-title">
                                    <span class=" at-sort b-b-ece fl">
                                        <!-- ÂÖ≥Ê≥® -->
                                        <a class=" choose c-666 fl" :class="{ active: activeTab === 'followers' }"
                                            @click="activeTab = 'followers'">
                                            ÂÖ≥Ê≥®
                                        </a>
                                        <!-- Á≤â‰∏ù -->
                                        <a class="choose c-666 fl" :class="{ active: activeTab === 'followed' }"
                                            @click="activeTab = 'followed'">
                                            Á≤â‰∏ù
                                        </a>
                                    </span>
                                </li>
                            </ul>

                            <div>
                                <!-- ‰ΩøÁî® v-if Âà§Êñ≠ÂΩìÂâçÊòØÂê¶‰∏∫‚ÄúÂÖ≥Ê≥®‚ÄùÈÄâÈ°πÂç° -->
                                <div v-if="activeTab === 'followers'" class="follow_box">
                                    <div class="column_box follow_box_box" id="like-box" v-for="follow in followers"
                                        :key="follow.userId" @click="userDetail(follow.userId)">
                                        <li class="follow_li">
                                            <el-image id="person-img" style="width: 48px; height: 48px;"
                                                :src="follow.avatar"></el-image>
                                            <i v-if="follow.isMutual == 1" class="el-icon-connection"
                                                style="position: relative; left: -14px;"></i>
                                        </li>
                                        <li class="person-intro-detail gradient-text" style="text-align: center;">
                                            <div>{{ follow.nickname }}</div>
                                        </li>
                                    </div>
                                    <div class="more" style=" position: absolute;
                                top: 56%;
                                left: 80%;">
                                        <el-button type="text" @click="followerMore" :loading="isLoading"
                                            class="more-btn">
                                            Êõ¥Â§ö...
                                        </el-button>
                                    </div>
                                </div>

                                <!-- ‰ΩøÁî® v-if Âà§Êñ≠ÂΩìÂâçÊòØÂê¶‰∏∫‚ÄúÁ≤â‰∏ù‚ÄùÈÄâÈ°πÂç° -->
                                <div v-if="activeTab === 'followed'" class="follow_box">
                                    <div class="column_box follow_box_box" id="like-box" v-for="follow in followed"
                                        :key="follow.userId" @click="userDetail(follow.userId)">
                                        <li class="follow_li">
                                            <el-image id="person-img" style="width: 48px; height: 48px;"
                                                :src="follow.avatar"></el-image>
                                            <i v-if="follow.isMutual == 1" class="el-icon-connection"
                                                style="position: relative; left: -14px;"></i>
                                        </li>
                                        <li class="person-intro-detail gradient-text" style="text-align: center;">
                                            <div>{{ follow.nickname }}</div>
                                        </li>
                                    </div>

                                    <div class="more" style="  position: absolute;
                                top: 56%;
                                left: 80%;">
                                        <el-button type="text" @click="followedMore" :loading="isLoading"
                                            class="more-btn">
                                            Êõ¥Â§ö...
                                        </el-button>
                                    </div>
                                </div>
                            </div>
                        </div>




                        <div class="column-container">
                            <ul class="column_box" id="like-box">
                                <li class="column-title">
                                    <span class="at-sort b-b-ece fl">
                                        <a class="at-sort-comment-a c-666 fl">ÁÇπÂáªÊéíË°å</a>
                                    </span>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </el-container>
            <div class="menu-box" id="menu-box">
                <div class="menu-button" id="menu-button">
                    <div class="line-box">
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="line"></div>
                    </div>
                </div>
                <div>
                    <ul class="menu-list">
                        <li><a target="_blank" @click="toggleStatus(0)"><span>üßßÊêúÁ¥¢ÂçöÂÆ¢</span></a></li>
                        <li><a target="_blank" @click="toggleStatus(1)"><span>üìßÂèëÂ∏ÉÂçöÂÆ¢</span></a></li>

                    </ul>
                </div>
            </div>


            <el-dialog :visible.sync="dialogVisible[0]" width="30%">
                <div id="search-nb">
                    <!-- ‰ΩøÁî® flexbox ‰ª£ÊõøÊµÆÂä®Â∏ÉÂ±Ä -->
                    <span class="search-s" style="display: flex; align-items: center;">
                        <!-- el-input Êèê‰æõ‰∫ÜÂç†‰ΩçÁ¨¶ÂäüËÉΩÔºåÊó†ÈúÄÈ¢ùÂ§ñÁöÑ label -->
                        <el-input class="search-input" placeholder="ËØ∑ËæìÂÖ•ÂÖ≥ÈîÆÂ≠ó" v-model="key" @keyup.enter="search">

                            <template #append>
                                <a class="search-icon fl" @click="search" href="javascript:void(0);">
                                    ÊêúÁ¥¢
                                </a>
                            </template>
                        </el-input>
                    </span>
                </div>
            </el-dialog>


            <el-dialog :visible.sync="dialogVisible[1]" width="30%">
                <el-form ref="newBlog" :model="newBlog" label-width="160px" :rules="newBlogRules">
                    <el-form-item label="Ê†áÈ¢ò" prop="title" disabled>
                        <el-input v-model="newBlog.title" placeholder="ËØ∑ËæìÂÖ•Ê†áÈ¢ò"></el-input>
                    </el-form-item>
                    <el-form-item label="Á±ªÂûã" prop="typeId">
                        <el-select v-model="newBlog.typeId" placeholder="ËØ∑ÈÄâÊã©ÂçöÂÆ¢Á±ªÂûã">
                            <el-option v-for="tag in tags" :key="tag.blogTypeId" :label="tag.typeName"
                                :value="tag.blogTypeId"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="Ê≠£Êñá" prop="content">
                        <el-input v-model="newBlog.content" minlength="10" type="textarea"
                            placeholder="ËØ∑ËæìÂÖ•Ê≠£Êñá"></el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-button type="primary" @click="onSubmitNew('newBlog')">ÂèëÂ∏É</el-button>
                    </el-form-item>
                </el-form>
            </el-dialog>
        </div>



        <!-- Footer content -->
        <footer class="footer">
            <div class="footer-line">Powered By Cross Fire ‚Ä¢ ¬© 2024</div>
        </footer>

    </div>

    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script type="text/javascript" src="/statics/js/js/sweetalert.min.js"></script>
    <script type="text/javascript" src="/statics/js/js/pace.min.js"></script>
    <script src="/statics/js/request.js"></script>
    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    form: { account: '', password: '', checkPassword: '' },
                    newBlogRules: {
                        title: [
                            { required: true, message: 'ËØ∑ËæìÂÖ•ÂçöÂÆ¢Ê†áÈ¢ò', trigger: 'blur' },
                            { min: 6, max: 20, message: 'ÈïøÂ∫¶Âú® 6 Âà∞ 20 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
                        ],
                        content: [
                            { required: true, message: 'ËØ∑ËæìÂÖ•Ê≠£Êñá', trigger: 'blur' },
                            { min: 10, max: 20000, message: 'Ê≠£ÊñáËá≥Â∞ë100Â≠ó', trigger: 'blur' }
                        ],
                        typeId: [
                            { required: true, message: 'ËØ∑ÈÄâÊã©Á±ªÂûã', trigger: 'blur' }
                        ]
                    },
                    personInfo: { name: '', avatar: '/statics/images/18908.png' },
                    newBlog: { title: '', content: '', typeId: null },
                    blogs: [],  // ÂçöÂÆ¢ÂàóË°®
                    pageParam: {  // ÂàÜÈ°µÂèÇÊï∞
                        current: 1,
                        size: 5,
                        totalSize: 0
                    },
                    tags: [],  // ÂçöÂÆ¢Á±ªÂûãÊ†áÁ≠æ
                    activeTab: 'followers',  // ÂΩìÂâçÊ¥ªÂä®Ê†áÁ≠æÔºàÂÖ≥Ê≥®ÊàñÁ≤â‰∏ùÔºâ
                    followers: [],  // ÂÖ≥Ê≥®Áî®Êà∑ÂàóË°®
                    followed: [],  // Á≤â‰∏ùÁî®Êà∑ÂàóË°®
                    activeIndex: '0',  // ÂΩìÂâçÂàÜÁ±ªÁ¥¢Âºï
                    key: '',  // ÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó
                    dialogVisible: [false, false],  // ÂºπÂá∫Ê°ÜÁä∂ÊÄÅ
                    drawer: false  // ÊäΩÂ±âÁä∂ÊÄÅ

                };

            },

            created() {
                this.initType();  // ÂàùÂßãÂåñÂçöÂÆ¢Á±ªÂûã
                this.initUser();  // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ
                this.initFollowers();  // ÂàùÂßãÂåñÂÖ≥Ê≥®ÂàóË°®
                this.initFolloweds();  // ÂàùÂßãÂåñÁ≤â‰∏ùÂàóË°®
                this.load();
                request.post('/followInfo', (res) => {
                    this.follow.userId = res.userId;
                }); // ÂàùÊ¨°Âä†ËΩΩÂçöÂÆ¢ÂàóË°®
            },
            methods: {
                // ÂàÜÈ°µ‰∫ã‰ª∂Â§ÑÁêÜ
                handlePageChange(page) {
                    this.pageParam.current = page;
                    this.load();  // Âä†ËΩΩÊñ∞ÁöÑÈ°µÁ†ÅÁöÑÂçöÂÆ¢
                },
                onSubmitNew(form) {
                    this.$refs[form].validate((valid) => {
                        if (valid) {
                            // Ê∑ªÂä† author Â≠óÊÆµ
                            this.newBlog.author = this.personInfo.userId;  // Â¶ÇÊûú currentUser ‰∏∫Á©∫Ôºå‰ΩøÁî® 'ÈªòËÆ§Áî®Êà∑'

                            // ËÆæÁΩÆÈªòËÆ§ÂÄº
                            this.newBlog.readed = 0;

                            // ÂèëÈÄÅËØ∑Ê±Ç
                            request.post("/addBlog", this.newBlog, (res) => {
                                if (res) {
                                    this.$message("ÂèëÂ∏ÉÊàêÂäü");
                                    this.toggleStatus(1);
                                }
                            });
                        }
                    });
                },

                // Âä†ËΩΩÂçöÂÆ¢Êï∞ÊçÆ
                load() {
                    const data = {
                        typeId: this.activeIndex === '0' ? undefined : this.activeIndex,
                        key: this.key.trim() || undefined
                    };
                    console.log('Loading blogs with params:', this.pageParam, data);  // ÊâìÂç∞ÂàÜÈ°µÂèÇÊï∞
                    this.initBlog(this.pageParam, data);  // Ëé∑ÂèñÂçöÂÆ¢Êï∞ÊçÆ
                },

                // ‰ªéÊúçÂä°Âô®Ëé∑ÂèñÂçöÂÆ¢Êï∞ÊçÆ
                async initBlog(params, data) {
                    const url = '/blogs';
                    await request.post(url, data, params, (res) => {
                        if (res && res.list) {
                            this.blogs = res.list;
                            this.pageParam.totalSize = res.totalSize;  // Êõ¥Êñ∞ÊÄªÊù°ÁõÆÊï∞
                            console.log('Total Size:', res.totalNumber);  // Ê£ÄÊü•ÊÄªÊù°ÁõÆÊï∞
                        }
                    });
                },

                // ÂàùÂßãÂåñÂçöÂÆ¢Á±ªÂûãÊ†áÁ≠æ
                async initType() {
                    await request.post("/types", (res) => { this.tags = res; });
                },

                // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ
                async initUser() {
                    await request.post("/personalInfomation", (res) => {
                        this.personInfo = res;
                    });
                },

                // ÂàùÂßãÂåñÂÖ≥Ê≥®ÂàóË°®
                async initFollowers() {
                    await request.post("/followers", (res) => {
                        this.followers = res;
                    });
                },

                // ÂàùÂßãÂåñÁ≤â‰∏ùÂàóË°®
                async initFolloweds() {
                    await request.post("/followeds", (res) => {
                        this.followed = res;
                    });
                },

                // Ë∑≥ËΩ¨Âà∞Êõ¥Â§öÂÖ≥Ê≥®È°µÈù¢
                followerMore() {
                    window.location = "/users/followers";
                },

                // Ë∑≥ËΩ¨Âà∞Êõ¥Â§öÁ≤â‰∏ùÈ°µÈù¢
                followedMore() {
                    window.location = "/users/followed";
                },

                // Áî®Êà∑ËØ¶ÊÉÖË∑≥ËΩ¨
                userDetail(id) {
                    console.log(id);
                    window.location = "/personInfo/" + id;
                },

                // Ë∑≥ËΩ¨Âà∞Áî®Êà∑‰∏™‰∫∫‰ø°ÊÅØÈ°µ
                toPersonInfo() {
                    if (this.personInfo.userId) {
                        window.location = '/personInfo/' + this.personInfo.userId;
                    } else {
                        console.error('User ID not available!');
                    }
                },
                toggleStatus(status) {
                    console.log(status)
                    console.log(!this.dialogVisible)
                    this.$set(this.dialogVisible, status, !this.dialogVisible[status])
                },

                // ÊêúÁ¥¢ÂäüËÉΩÂ§ÑÁêÜ
                search() {
                    this.pageParam.current = 1;  // ÈáçÁΩÆÈ°µÁ†Å‰∏∫Á¨¨‰∏ÄÈ°µ
                    this.blogs = [];  // Ê∏ÖÁ©∫ÂΩìÂâçÂçöÂÆ¢ÂàóË°®
                    this.load();  // ÈáçÊñ∞Âä†ËΩΩÂçöÂÆ¢Êï∞ÊçÆ
                },

                // Ë∑≥ËΩ¨Âà∞ÂçöÂÆ¢ËØ¶ÊÉÖÈ°µ
                blogDetail(id) {
                    window.location = "/blog/" + id;
                }
            },

            filters: {
                // Êó•ÊúüÊ†ºÂºèÂåñËøáÊª§Âô®
                dateFormate(date) {
                    return date.substring(0, 10);  // Ê†ºÂºèÂåñÊó•Êúü‰∏∫ 'YYYY-MM-DD'
                }
            }
        });
    </script>

    <script>
        new Vue({
            el: 'nav',
            data() {
                return {
                    personInfo: { userId: '' },
                    key: '',
                };
            },
            created() {
                this.initUser();
            },
            methods: {
                logout() {
                    window.sessionStorage.removeItem('token')
                    //document.cookie = `token=${res.token}; expires=${ data.getDate() -10 }`
                    let date = new Date()
                    date.setDate(date.getDate() - 1)
                    document.cookie = `token=""; expires=${date.toUTCString()}`
                    window.location = "/login"
                },


                async initUser() {
                    await request.post("/personalInfomation", (res) => {
                        this.personInfo = res;
                    });
                },
            }
        });
    </script>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const menuBox = document.querySelector('.menu-box');
            const menuButton = document.querySelector('.menu-button');

            menuButton.addEventListener('click', function () {
                menuBox.classList.toggle('active');
            });

            let isDragging = false;
            let startX, startY, initialX, initialY;

            menuBox.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                initialX = menuBox.offsetLeft;
                initialY = menuBox.offsetTop;
                menuBox.style.cursor = 'grabbing';

                const onMouseMove = (e) => {
                    if (isDragging) {
                        const dx = e.clientX - startX;
                        const dy = e.clientY - startY;
                        menuBox.style.left = `${initialX + dx}px`;
                        menuBox.style.top = `${initialY + dy}px`;
                    }
                };

                const onMouseUp = () => {
                    isDragging = false;
                    menuBox.style.cursor = 'grab';
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                };

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
        });

    </script>


</body>

</html>